# =====================================================
# Test Configuration for Intelligent Recruitment Platform
# =====================================================
spring.application.name=recrutement-intelligent-test

# =====================================================
# Test Profile Configuration
# =====================================================
spring.profiles.active=test
spring.main.allow-bean-definition-overriding=true

# =====================================================
# Test Database Configuration (TestContainers PostgreSQL)
# =====================================================
# These properties will be overridden by TestContainers
# Default values here for documentation purposes
spring.datasource.url=jdbc:tc:postgresql:16-alpine:///recrutement_test?TC_DAEMON=true&TC_INITSCRIPT=schema.sql
spring.datasource.username=test
spring.datasource.password=test
spring.datasource.driver-class-name=org.testcontainers.jdbc.ContainerDatabaseDriver

# HikariCP Configuration (smaller pool for tests)
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# =====================================================
# JPA / Hibernate Configuration for Tests
# =====================================================
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Disable statistics for faster tests
spring.jpa.properties.hibernate.generate_statistics=false

# =====================================================
# OpenAI Configuration (Mock for tests - use stub)
# =====================================================
spring.ai.openai.api-key=test-api-key-for-mocking
spring.ai.openai.chat.options.model=gpt-4
spring.ai.openai.chat.options.temperature=0.7
spring.ai.openai.chat.options.max-tokens=2000

# =====================================================
# Embedding Model Configuration (Test)
# =====================================================
spring.ai.openai.embedding.options.model=text-embedding-3-small
spring.ai.openai.embedding.options.dimensions=1536

# =====================================================
# Vector Store Configuration (PgVector - disabled for tests)
# =====================================================
# Disable pgvector for unit tests - enable in integration tests only
spring.ai.vectorstore.pgvector.initialize-schema=false

# =====================================================
# JWT Configuration for Tests
# =====================================================
jwt.secret=SZItJyYFZDk1c2I5kO8lb062r0NPQcOyItZyLDG3n9yPcIn2r3JIlI7oYoOlTQz1Ftg9btoyZIXPjxGFYte7TQ==
jwt.expiration=3600000
jwt.refresh-expiration=7200000

# =====================================================
# File Upload Configuration for Tests
# =====================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

file.upload-dir=./uploads/test-cv

# =====================================================
# CORS Configuration
# =====================================================
cors.allowed-origins=http://localhost:3000,http://localhost:4200
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true
cors.max-age=3600

# =====================================================
# Logging Configuration (minimal for tests)
# =====================================================
logging.level.root=WARN
logging.level.ma.recrutement=DEBUG
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN
logging.level.org.springframework.test=INFO

# =====================================================
# SpringDoc OpenAPI (disabled for tests)
# =====================================================
springdoc.api-docs.enabled=false
springdoc.swagger-ui.enabled=false

# =====================================================
# Test-Specific Properties
# =====================================================
# Disable batch inserts for clearer test assertions
spring.jpa.properties.hibernate.jdbc.batch_size=0

# Enable transaction rollback for tests
spring.test.database.replace=none
